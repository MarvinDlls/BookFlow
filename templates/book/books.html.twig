{% extends 'base.html.twig' %}

{% block title %}{{ title }}{% endblock %}

{% block body %}
	<div class="container mx-auto p-6">
		<h1 class="text-3xl font-bold text-center mb-6">{{ title }}</h1>

		{# Affichage des messages flash #}
		{% for label, messages in app.flashes %}
			{% for message in messages %}
				<div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
					{{ message }}
					<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
			{% endfor %}
		{% endfor %}

		{# Formulaire de recherche #}
		<div class="mb-4">
			<form action="{{ path('app_books_search') }}" method="get" class="d-flex">
				<input type="text" name="q" class="form-control me-2" placeholder="Rechercher un livre...">
				<button type="submit" class="btn btn-primary">Rechercher</button>
			</form>
		</div>

		{% if pagination|length == 0 %}
			<div class="alert alert-info text-center">
				Aucun livre trouvé.
			</div>
		{% else %}
			<section class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
				{% for book in pagination %}
					{% if book.thumbnail %}
						<article class="w-full h-full mx-auto max-w-sm shadow-xl bg-cover bg-center min-h-150 transform duration-500 hover:-translate-y-2 cursor-pointer group" style="background-image: url('{{ book.thumbnail }}');">
					{% else %}
						<article class="w-full h-full mx-auto max-w-sm shadow-xl bg-cover bg-center min-h-150 transform duration-500 hover:-translate-y-2 cursor-pointer group">
					{% endif %}
						<div class="bg-black bg-opacity-20 h-full px-1 flex flex-wrap flex-col justify-end pt-72 hover:bg-opacity-75 transform duration-300">
							<h1 class="text-white text-2xl mb-5 transform translate-y-20 group-hover:translate-y-0 duration-300">
								{{ book.title }}
							</h1>
							<h5 class="text-white mb-5 transform translate-y-20 group-hover:translate-y-0 duration-300">
								{% if book.authors %}
									{{ book.authors|join(', ') }}
								{% endif %}
							</h5>

							<div class="w-16 h-2 bg-red-600 rounded-full mb-5 transform translate-y-20 group-hover:translate-y-0 duration-300"></div>

							<p class="opacity-0 text-white text group-hover:opacity-80 transform duration-500">
								{{ book.description|length > 100 ? book.description|slice(0, 100) ~ '...' : book.description }}
							</p>

							<div class="flex flex-wrap justify-center text-white cursor-pointer text-lg font-semibold gap-2 py-2">
								<a href="{{ path('app_book_details', {'id': book.id}) }}" class="px-4 hover:border-b-2 hover:border-red-800 rounded-b-md">
									Voir détails
								</a>
								<a href="{{ path('app_book_preview', {'id': book.id}) }}" class="px-4 hover:border-b-2 hover:border-red-800 rounded-b-md">
									Aperçu
								</a>
							</div>
						</div>
					</article>
				{% endfor %}
			</section>

			{# Pagination links #}
			<div class="mt-6 flex justify-center">
				{{ knp_pagination_render(pagination) }}
			</div>
		{% endif %}
	</div>
{% endblock %}
